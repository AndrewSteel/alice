(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{28:(e,t,r)=>{"use strict";r.d(t,{L:()=>i,WG:()=>c,gf:()=>a,iD:()=>l,ri:()=>u,tf:()=>s});let o="/api/webhook/auth",n="alice_token";function a(){return localStorage.getItem(n)}function c(e){localStorage.setItem(n,e)}function i(){localStorage.removeItem(n)}async function l(e,t){let r;try{r=await fetch("".concat(o,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})})}catch(e){throw Error("NETWORK_ERROR")}if(!r.ok)throw Error("Ung\xfcltige Anmeldedaten");return r.json()}async function s(e){let t=await fetch("".concat(o,"/validate"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("Token ung\xfcltig");return(await t.json()).user}async function u(e){fetch("".concat(o,"/logout"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}}).catch(()=>{}),i()}},63:(e,t,r)=>{"use strict";var o=r(7260);r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}})},875:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>s,c:()=>l});var o=r(5155),n=r(2115),a=r(63),c=r(9117),i=r(28);let l=(0,n.createContext)(null);function s(e){let{children:t}=e,r=(0,a.useRouter)(),[s,u]=(0,n.useState)(null),[d,f]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=(0,i.gf)();if(!e){f(!1),r.replace("/login");return}try{let t=(0,c.i)(e).exp;if(t&&Date.now()/1e3>t){(0,i.L)(),f(!1),r.replace("/login");return}}catch(e){(0,i.L)(),f(!1),r.replace("/login");return}(0,i.tf)(e).then(e=>u(e)).catch(()=>{(0,i.L)(),r.replace("/login")}).finally(()=>f(!1))},[r]);let h=(0,n.useCallback)((e,t)=>{(0,i.WG)(e),u(t)},[]),p=(0,n.useCallback)(()=>{let e=(0,i.gf)();e&&(0,i.ri)(e),u(null),r.replace("/login")},[r]);return(0,o.jsx)(l.Provider,{value:{user:s,isLoading:d,login:h,logout:p},children:t})}},3419:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,3673,23)),Promise.resolve().then(r.bind(r,875))},3673:()=>{},9117:(e,t,r)=>{"use strict";r.d(t,{i:()=>i}),new TextEncoder;let o=new TextDecoder;class n extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class a extends n{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class c extends n{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t)}}function i(e){let t,r;if("string"!=typeof e)throw new a("JWTs must use Compact JWS serialization, JWT must be a string");let{1:n,length:c}=e.split(".");if(5===c)throw new a("Only JWTs using Compact JWS serialization can be decoded");if(3!==c)throw new a("Invalid JWT");if(!n)throw new a("JWTs must contain a payload");try{t=function(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64("string"==typeof e?e:o.decode(e),{alphabet:"base64url"});let t=e;t instanceof Uint8Array&&(t=o.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/");try{var r=t;if(Uint8Array.fromBase64)return Uint8Array.fromBase64(r);let e=atob(r),o=new Uint8Array(e.length);for(let t=0;t<e.length;t++)o[t]=e.charCodeAt(t);return o}catch{throw TypeError("The input to be decoded is not correctly encoded.")}}(n)}catch{throw new a("Failed to base64url decode the payload")}try{r=JSON.parse(o.decode(t))}catch{throw new a("Failed to parse the decoded payload as JSON")}if(!function(e){if("object"!=typeof e||null===e||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(r))throw new a("Invalid JWT Claims Set");return r}}},e=>{e.O(0,[978,441,255,358],()=>e(e.s=3419)),_N_E=e.O()}]);