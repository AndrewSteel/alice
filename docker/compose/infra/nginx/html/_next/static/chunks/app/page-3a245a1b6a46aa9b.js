(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{28:(e,t,a)=>{"use strict";a.d(t,{L:()=>i,WG:()=>l,gf:()=>n,iD:()=>o,ri:()=>c,tf:()=>d});let r="/api/auth",s="alice_token";function n(){return localStorage.getItem(s)}function l(e){localStorage.setItem(s,e)}function i(){localStorage.removeItem(s)}async function o(e,t){let a;try{a=await fetch("".concat(r,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})})}catch(e){throw Error("NETWORK_ERROR")}if(!a.ok)throw Error("Ung\xfcltige Anmeldedaten");return a.json()}async function d(e){let t=await fetch("".concat(r,"/validate"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("Token ung\xfcltig");return(await t.json()).user}async function c(e){fetch("".concat(r,"/logout"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}}).catch(()=>{}),i()}},854:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(2115),s=a(875);function n(){let e=(0,r.useContext)(s.c);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},875:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>d,c:()=>o});var r=a(5155),s=a(2115),n=a(63),l=a(9117),i=a(28);let o=(0,s.createContext)(null);function d(e){let{children:t}=e,a=(0,n.useRouter)(),[d,c]=(0,s.useState)(null),[u,m]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=(0,i.gf)();if(!e){m(!1),a.replace("/login");return}try{let t=(0,l.i)(e).exp;if(t&&Date.now()/1e3>t){(0,i.L)(),m(!1),a.replace("/login");return}}catch(e){(0,i.L)(),m(!1),a.replace("/login");return}(0,i.tf)(e).then(e=>c(e)).catch(()=>{(0,i.L)(),a.replace("/login")}).finally(()=>m(!1))},[a]);let f=(0,s.useCallback)((e,t)=>{(0,i.WG)(e),c(t)},[]),x=(0,s.useCallback)(()=>{let e=(0,i.gf)();e&&(0,i.ri)(e),c(null),a.replace("/login")},[a]);return(0,r.jsx)(o.Provider,{value:{user:d,isLoading:u,login:f,logout:x},children:t})}},2325:(e,t,a)=>{Promise.resolve().then(a.bind(a,6347)),Promise.resolve().then(a.bind(a,3197))},3197:(e,t,a)=>{"use strict";a.d(t,{AppShell:()=>eN});var r=a(5155),s=a(2115),n=a(2241),l=a(6297),i=a(3101),o=a(6615),d=a(4269);let c=l.bL;l.l9,l.bm;let u=l.ZL,m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.hJ,{className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t})});m.displayName=l.hJ.displayName;let f=(0,i.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),x=s.forwardRef((e,t)=>{let{side:a="right",className:s,children:n,...i}=e;return(0,r.jsxs)(u,{children:[(0,r.jsx)(m,{}),(0,r.jsxs)(l.UC,{ref:t,className:(0,d.cn)(f({side:a}),s),...i,children:[n,(0,r.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=l.UC.displayName;let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.hE,{ref:t,className:(0,d.cn)("text-lg font-semibold text-foreground",a),...s})});h.displayName=l.hE.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.VY,{ref:t,className:(0,d.cn)("text-sm text-muted-foreground",a),...s})}).displayName=l.VY.displayName;var p=a(3998),g=a(8599);let b=g.Kq,y=g.bL,v=g.l9,N=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...n}=e;return(0,r.jsx)(g.UC,{ref:t,sideOffset:s,className:(0,d.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",a),...n})});N.displayName=g.UC.displayName;var j=a(6524);let w=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(j.bL,{ref:t,className:(0,d.cn)("relative overflow-hidden",a),...n,children:[(0,r.jsx)(j.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,r.jsx)(k,{}),(0,r.jsx)(j.OK,{})]})});w.displayName=j.bL.displayName;let k=s.forwardRef((e,t)=>{let{className:a,orientation:s="vertical",...n}=e;return(0,r.jsx)(j.VM,{ref:t,orientation:s,className:(0,d.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...n,children:(0,r.jsx)(j.lr,{className:"relative flex-1 rounded-full bg-border"})})});k.displayName=j.VM.displayName;var C=a(5418),A=a(4216);function S(e){let{onCollapse:t}=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between px-3 py-3 border-b border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(C.A,{className:"h-5 w-5 text-blue-500","aria-hidden":!0}),(0,r.jsx)("span",{className:"font-semibold text-gray-100",children:"Alice"})]}),(0,r.jsxs)(y,{children:[(0,r.jsx)(v,{asChild:!0,children:(0,r.jsx)(p.$,{variant:"ghost",size:"icon",onClick:t,className:"h-7 w-7 text-gray-400 hover:text-gray-100 hover:bg-gray-700","aria-label":"Sidebar einklappen",children:(0,r.jsx)(A.A,{className:"h-4 w-4"})})}),(0,r.jsx)(N,{side:"right",children:"Sidebar einklappen"})]})]})}var R=a(2265);function E(e){let{onClick:t}=e;return(0,r.jsxs)(p.$,{variant:"ghost",onClick:t,className:"w-full justify-start gap-2 px-3 text-gray-300 hover:text-gray-100 hover:bg-gray-700",children:[(0,r.jsx)(R.A,{className:"h-4 w-4","aria-hidden":!0}),"Neuer Chat"]})}var z=a(109),D=a(5142);function _(e){let{value:t,onChange:a}=e;return(0,r.jsxs)("div",{className:"relative px-2",children:[(0,r.jsx)(z.A,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-500 pointer-events-none"}),(0,r.jsx)(D.p,{type:"search",placeholder:"Suche",value:t,onChange:e=>a(e.target.value),className:"pl-8 h-8 bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-500 text-sm focus:border-blue-500","aria-label":"Chats durchsuchen"})]})}var L=a(4640),O=a(3630);function U(e){let{session:t,isActive:a,onSelect:n,onDelete:l}=e,[i,o]=(0,s.useState)(!1);return(0,r.jsxs)("div",{role:"button",tabIndex:0,onClick:()=>n(t.id),onKeyDown:e=>"Enter"===e.key&&n(t.id),onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),className:(0,d.cn)("group flex items-center justify-between rounded-md px-3 py-2 text-sm cursor-pointer select-none transition-colors",a?"bg-gray-700 text-gray-100":"text-gray-400 hover:bg-gray-700/60 hover:text-gray-200"),children:[(0,r.jsx)("span",{className:"truncate flex-1",children:t.title}),i&&(0,r.jsxs)("div",{className:"flex items-center gap-1 ml-1 shrink-0",children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation()},className:"p-0.5 text-gray-400 hover:text-gray-100","aria-label":"Chat umbenennen",children:(0,r.jsx)(L.A,{className:"h-3.5 w-3.5"})}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),l(t.id)},className:"p-0.5 text-gray-400 hover:text-red-400","aria-label":"Chat l\xf6schen",children:(0,r.jsx)(O.A,{className:"h-3.5 w-3.5"})})]})]})}function P(e){let{sessions:t,activeId:a,searchQuery:n,onSelect:l,onDelete:i}=e,o=(0,s.useMemo)(()=>{if(!n.trim())return t;let e=n.toLowerCase();return t.filter(t=>t.title.toLowerCase().includes(e))},[t,n]),d=(0,s.useMemo)(()=>(function(e){let t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),r=a-864e5,s=a-6048e5,n={Heute:[],Gestern:[],"Diese Woche":[],Ã„lter:[]};for(let t of e){let e=new Date(t.updatedAt).getTime();e>=a?n.Heute.push(t):e>=r?n.Gestern.push(t):e>=s?n["Diese Woche"].push(t):n["\xc4lter"].push(t)}return Object.entries(n).filter(e=>{let[,t]=e;return t.length>0}).map(e=>{let[t,a]=e;return{label:t,items:a}})})(o),[o]);return 0===o.length?(0,r.jsx)("p",{className:"px-3 py-4 text-sm text-gray-500 text-center",children:n?"Keine Ergebnisse":"Noch keine Chats"}):(0,r.jsx)("nav",{"aria-label":"Chat-Verlauf",className:"space-y-4 px-2",children:d.map(e=>{let{label:t,items:s}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"px-1 mb-1 text-xs font-medium text-gray-500 uppercase tracking-wider",children:t}),(0,r.jsx)("div",{className:"space-y-0.5",children:s.map(e=>(0,r.jsx)(U,{session:e,isActive:e.id===a,onSelect:l,onDelete:i},e.id))})]},t)})})}var I=a(3063),V=a(8428),J=a(219);let M=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(J.bL,{ref:t,className:(0,d.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s})});M.displayName=J.bL.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(J._V,{ref:t,className:(0,d.cn)("aspect-square h-full w-full",a),...s})}).displayName=J._V.displayName;let T=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(J.H4,{ref:t,className:(0,d.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s})});T.displayName=J.H4.displayName;var H=a(7114),K=a(3263),F=a(2251),W=a(5797);let $=H.bL,G=H.l9;H.YJ,H.ZL,H.Pb,H.z6,s.forwardRef((e,t)=>{let{className:a,inset:s,children:n,...l}=e;return(0,r.jsxs)(H.ZP,{ref:t,className:(0,d.cn)("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",a),...l,children:[n,(0,r.jsx)(K.A,{className:"ml-auto"})]})}).displayName=H.ZP.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(H.G5,{ref:t,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",a),...s})}).displayName=H.G5.displayName;let Z=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...n}=e;return(0,r.jsx)(H.ZL,{children:(0,r.jsx)(H.UC,{ref:t,sideOffset:s,className:(0,d.cn)("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",a),...n})})});Z.displayName=H.UC.displayName;let q=s.forwardRef((e,t)=>{let{className:a,inset:s,...n}=e;return(0,r.jsx)(H.q7,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",a),...n})});q.displayName=H.q7.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,checked:n,...l}=e;return(0,r.jsxs)(H.H_,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:n,...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(H.VF,{children:(0,r.jsx)(F.A,{className:"h-4 w-4"})})}),s]})}).displayName=H.H_.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(H.hN,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(H.VF,{children:(0,r.jsx)(W.A,{className:"h-2 w-2 fill-current"})})}),s]})}).displayName=H.hN.displayName,s.forwardRef((e,t)=>{let{className:a,inset:s,...n}=e;return(0,r.jsx)(H.JU,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",a),...n})}).displayName=H.JU.displayName;let B=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(H.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...s})});B.displayName=H.wv.displayName;var Y=a(854);function Q(){let{user:e,logout:t}=(0,Y.A)();if(!e)return null;let a=e.username.slice(0,2).toUpperCase();return(0,r.jsx)("div",{className:"border-t border-gray-700 px-3 py-3",children:(0,r.jsxs)($,{children:[(0,r.jsx)(G,{asChild:!0,children:(0,r.jsxs)("button",{className:"flex items-center gap-2.5 w-full rounded-md px-2 py-1.5 hover:bg-gray-700 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[(0,r.jsx)(M,{className:"h-8 w-8 bg-blue-600 shrink-0",children:(0,r.jsx)(T,{className:"bg-blue-600 text-white text-xs font-semibold",children:a})}),(0,r.jsxs)("div",{className:"flex flex-col items-start min-w-0",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-100 truncate",children:e.username}),(0,r.jsx)("span",{className:"text-xs text-gray-400 capitalize",children:e.role})]})]})}),(0,r.jsxs)(Z,{side:"top",align:"start",className:"w-48 bg-gray-800 border-gray-700",children:[(0,r.jsxs)(q,{className:"gap-2 text-gray-300 focus:text-gray-100 focus:bg-gray-700 cursor-pointer",children:[(0,r.jsx)(I.A,{className:"h-4 w-4","aria-hidden":!0}),"Einstellungen"]}),(0,r.jsx)(B,{className:"bg-gray-700"}),(0,r.jsxs)(q,{onClick:t,className:"gap-2 text-red-400 focus:text-red-300 focus:bg-gray-700 cursor-pointer",children:[(0,r.jsx)(V.A,{className:"h-4 w-4","aria-hidden":!0}),"Abmelden"]})]})]})})}var X=a(6848),ee=a(7500),et=a(8595),ea=a(140),er=a(7950),es=a(9678),en=a(8772),el=a(2925);let ei=[{label:"n8n",url:"https://n8n.happy-mining.de",icon:X.A,external:!0},{label:"Open WebUI",url:"https://openwebui.happy-mining.de",icon:ee.A,external:!0},{label:"Home Assistant",url:"https://homeassistant.happy-mining.de",icon:et.A,external:!0},{label:"HA Development",url:"https://hassdev.happy-mining.de",icon:ea.A,external:!0},{label:"Kanboard",url:"https://kanboard.happy-mining.de",icon:er.A,external:!0},{label:"Jupyter",url:"https://jupyter.happy-mining.de",icon:es.A,external:!0},{label:"Finance Upload",url:"/finance_upload/index.html",icon:en.A,external:!1}];function eo(e){let{onLinkClick:t}=e;return(0,r.jsxs)("div",{className:"border-t border-gray-700 px-3 py-3",children:[(0,r.jsx)("p",{className:"px-1 mb-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Services"}),(0,r.jsx)("nav",{"aria-label":"Externe Services",className:"space-y-0.5",children:ei.map(e=>{let a=e.icon;return(0,r.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer","aria-label":e.label,onClick:t,className:"flex items-center gap-2.5 rounded-md px-2 py-1.5 text-sm text-gray-300 hover:bg-gray-700 hover:text-gray-100 transition-colors group",children:[(0,r.jsx)(a,{className:"h-4 w-4 shrink-0","aria-hidden":"true"}),(0,r.jsx)("span",{className:"truncate flex-1",children:e.label}),e.external&&(0,r.jsx)(el.A,{className:"h-3 w-3 shrink-0 text-gray-600 group-hover:text-gray-400 transition-colors","aria-hidden":"true"})]},e.label)})})]})}function ed(e){let{sessions:t,activeSessionId:a,onNewChat:n,onSelectSession:l,onDeleteSession:i,onCollapse:o,onServiceLinkClick:d}=e,[c,u]=(0,s.useState)("");return(0,r.jsxs)("div",{className:"flex flex-col h-full bg-gray-900 w-full",children:[(0,r.jsx)(S,{onCollapse:o}),(0,r.jsxs)("div",{className:"px-2 py-2 space-y-1",children:[(0,r.jsx)(E,{onClick:n}),(0,r.jsx)(_,{value:c,onChange:u})]}),(0,r.jsx)(w,{className:"flex-1 overflow-y-auto py-1",children:(0,r.jsx)(P,{sessions:t,activeId:a,searchQuery:c,onSelect:l,onDelete:i})}),(0,r.jsx)(eo,{onLinkClick:d}),(0,r.jsx)(Q,{})]})}var ec=a(8770);function eu(e){let{role:t,content:a}=e;if("error"===t)return(0,r.jsx)("div",{className:"flex items-start gap-3 px-4 py-2",children:(0,r.jsxs)("div",{className:"flex items-start gap-2 rounded-2xl bg-red-900/40 border border-red-700/50 px-4 py-3 max-w-[85%] md:max-w-[70%]",children:[(0,r.jsx)(ec.A,{className:"h-4 w-4 text-red-400 mt-0.5 shrink-0"}),(0,r.jsx)("p",{className:"text-sm text-red-300 whitespace-pre-wrap break-words",children:a})]})});let s="user"===t;return(0,r.jsx)("div",{className:(0,d.cn)("flex px-4 py-2",s?"justify-end":"justify-start"),children:(0,r.jsx)("div",{className:(0,d.cn)("max-w-[85%] md:max-w-[70%] rounded-2xl px-4 py-3",s?"bg-gray-600 text-gray-100":"bg-transparent text-gray-200"),children:(0,r.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words",children:a})})})}function em(){return(0,r.jsx)("div",{className:"flex items-start gap-3 px-4 py-2","aria-label":"Alice antwortet",children:(0,r.jsxs)("div",{className:"flex items-center gap-1.5 rounded-2xl bg-gray-700 px-4 py-3",children:[(0,r.jsx)("span",{className:"h-2 w-2 rounded-full bg-gray-400 animate-bounce [animation-delay:0ms]"}),(0,r.jsx)("span",{className:"h-2 w-2 rounded-full bg-gray-400 animate-bounce [animation-delay:150ms]"}),(0,r.jsx)("span",{className:"h-2 w-2 rounded-full bg-gray-400 animate-bounce [animation-delay:300ms]"}),(0,r.jsx)("span",{className:"sr-only",children:"Alice antwortet..."})]})})}function ef(e){let{messages:t,isLoading:a}=e,n=(0,s.useRef)(null);return((0,s.useEffect)(()=>{var e;null==(e=n.current)||e.scrollIntoView({behavior:"smooth"})},[t,a]),0!==t.length||a)?(0,r.jsxs)("div",{className:"flex flex-col flex-1 overflow-y-auto py-4",role:"log","aria-label":"Chatverlauf",children:[t.map((e,t)=>(0,r.jsx)(eu,{role:e.role,content:e.content},t)),a&&(0,r.jsx)(em,{}),(0,r.jsx)("div",{ref:n})]}):(0,r.jsx)("div",{className:"flex flex-1 items-center justify-center h-full",children:(0,r.jsxs)("div",{className:"text-center space-y-3",children:[(0,r.jsx)(ee.A,{className:"h-10 w-10 text-gray-500 mx-auto"}),(0,r.jsx)("p",{className:"text-gray-400 text-base",children:"Wie kann ich helfen?"})]})})}var ex=a(4979);let eh=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("textarea",{className:(0,d.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});function ep(e){let{onSend:t,disabled:a}=e,[n,l]=(0,s.useState)(""),i=(0,s.useRef)(null),o=n.trim().length>0&&!a,d=(0,s.useCallback)(()=>{o&&(t(n),l(""),i.current&&(i.current.style.height="auto"))},[o,t,n]),c=(0,s.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d())},[d]),u=(0,s.useCallback)(e=>{l(e.target.value);let t=e.target;t.style.height="auto",t.style.height=Math.min(t.scrollHeight,200)+"px"},[]);return(0,r.jsx)("div",{className:"border-t border-gray-700 bg-gray-800 px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-end gap-2 max-w-3xl mx-auto",children:[(0,r.jsx)(eh,{ref:i,value:n,onChange:u,onKeyDown:c,placeholder:"Nachricht eingeben...",disabled:a,rows:1,className:"flex-1 resize-none bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400 focus-visible:ring-gray-500 min-h-[44px] max-h-[200px]","aria-label":"Nachricht eingeben"}),(0,r.jsx)(p.$,{onClick:d,disabled:!o,size:"icon",className:"h-[44px] w-[44px] shrink-0 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:text-gray-400","aria-label":"Nachricht senden",children:(0,r.jsx)(ex.A,{className:"h-4 w-4"})})]})})}function eg(e){let{messages:t,isLoading:a,onSend:s}=e;return(0,r.jsxs)("div",{className:"flex flex-col h-full bg-gray-800",children:[(0,r.jsx)(ef,{messages:t,isLoading:a}),(0,r.jsx)(ep,{onSend:s,disabled:a})]})}eh.displayName="Textarea";var eb=a(28);async function ey(e,t){var a,r,s;let n,l=(0,eb.gf)();if(!l)throw window.location.href="/login",Error("No authentication token available");try{n=await fetch("/api/webhook/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l)},body:JSON.stringify({messages:e,session_id:t})})}catch(e){throw Error("Netzwerkfehler -- bitte pruefe deine Verbindung und versuche es erneut.")}if(401===n.status)throw(0,eb.L)(),window.location.href="/login",Error("Session abgelaufen -- bitte erneut anmelden.");if(!n.ok)throw Error("Serverfehler (".concat(n.status,") -- bitte versuche es erneut."));let i=null==(s=(await n.json()).choices)||null==(r=s[0])||null==(a=r.message)?void 0:a.content;if(!i)throw Error("Keine Antwort von Alice erhalten.");return i}let ev="alice_sessions";function eN(){let[e,t]=(0,s.useState)(!1),[a,l]=(0,s.useState)(!1),{sessions:i,sessionsLoaded:o,activeSessionId:d,messages:u,isLoading:m,createNewSession:f,selectSession:g,deleteSession:y,sendMessage:v}=function(){var e;let[t,a]=(0,s.useState)([]),[r,n]=(0,s.useState)(null),[l,i]=(0,s.useState)({}),[o,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!1),m=(0,s.useRef)(!1);(0,s.useEffect)(()=>{if(m.current)return;m.current=!0;let e=function(){try{let e=localStorage.getItem(ev);if(!e)return[];return JSON.parse(e).map(e=>({...e,updatedAt:new Date(e.updatedAt)}))}catch(e){return[]}}();e.length>0&&a(e),u(!0)},[]),(0,s.useEffect)(()=>{if(m.current&&t.length>0)localStorage.setItem(ev,JSON.stringify(t));else m.current&&0===t.length&&localStorage.removeItem(ev)},[t]);let f=r&&null!=(e=l[r])?e:[],x=(0,s.useCallback)(()=>{let e=crypto.randomUUID(),t={id:e,title:"Neuer Chat",updatedAt:new Date};return a(e=>[t,...e]),n(e),e},[]),h=(0,s.useCallback)(e=>{n(e)},[]),p=(0,s.useCallback)(e=>{if(a(t=>t.filter(t=>t.id!==e)),i(t=>{let a={...t};return delete a[e],a}),r===e){let e=crypto.randomUUID(),t={id:e,title:"Neuer Chat",updatedAt:new Date};a(e=>[t,...e]),n(e)}},[r]),g=(0,s.useCallback)(async e=>{if(!r||!e.trim()||o)return;let t={role:"user",content:e.trim(),timestamp:new Date};i(e=>{var a;let s=null!=(a=e[r])?a:[];return{...e,[r]:[...s,t]}}),a(t=>t.map(t=>{var a;if(t.id!==r)return t;let s="Neuer Chat"===t.title&&!(null!=(a=l[r])?a:[]).some(e=>"user"===e.role);return{...t,title:s?e.trim().slice(0,40):t.title,updatedAt:new Date}})),d(!0);try{var s;let t=[...(null!=(s=l[r])?s:[]).filter(e=>"error"!==e.role).map(e=>({role:e.role,content:e.content})),{role:"user",content:e.trim()}],a=await ey(t,r),n={role:"assistant",content:a,timestamp:new Date};i(e=>{var t;let a=null!=(t=e[r])?t:[];return{...e,[r]:[...a,n]}})}catch(t){let e={role:"error",content:t instanceof Error?t.message:"Ein unbekannter Fehler ist aufgetreten.",timestamp:new Date};i(t=>{var a;let s=null!=(a=t[r])?a:[];return{...t,[r]:[...s,e]}})}finally{d(!1)}},[r,o,l]);return{sessions:t,sessionsLoaded:c,activeSessionId:r,messages:f,isLoading:o,createNewSession:x,selectSession:h,deleteSession:p,sendMessage:g}}();(0,s.useEffect)(()=>{o&&(0===i.length?f():d||g(i[0].id))},[o]);let N={sessions:i.map(e=>({id:e.id,title:e.title,updatedAt:e.updatedAt})),activeSessionId:d,onNewChat:function(){f(),t(!1)},onSelectSession:function(e){g(e),t(!1)},onDeleteSession:function(e){y(e)},onCollapse:()=>l(!0),onServiceLinkClick:()=>t(!1)};return(0,r.jsx)(b,{children:(0,r.jsxs)("div",{className:"flex h-screen bg-gray-800 overflow-hidden",children:[!a&&(0,r.jsx)("aside",{className:"hidden md:flex flex-col w-[260px] shrink-0 border-r border-gray-700",children:(0,r.jsx)(ed,{...N})}),(0,r.jsx)(c,{open:e,onOpenChange:t,children:(0,r.jsxs)(x,{side:"left",className:"w-[260px] p-0 bg-gray-900 border-gray-700",children:[(0,r.jsx)(h,{className:"sr-only",children:"Navigation"}),(0,r.jsx)(ed,{...N,onCollapse:()=>t(!1)})]})}),(0,r.jsxs)("div",{className:"flex flex-col flex-1 min-w-0",children:[(0,r.jsxs)("header",{className:"md:hidden flex items-center gap-2 px-4 py-3 border-b border-gray-700 bg-gray-900",children:[(0,r.jsx)(p.$,{variant:"ghost",size:"icon",onClick:()=>t(!0),className:"text-gray-400 hover:text-gray-100","aria-label":"Menue oeffnen",children:(0,r.jsx)(n.A,{className:"h-5 w-5"})}),(0,r.jsx)("span",{className:"font-semibold text-gray-100",children:"Alice"})]}),a&&(0,r.jsx)("div",{className:"hidden md:flex items-center px-4 py-3 border-b border-gray-700 bg-gray-900",children:(0,r.jsx)(p.$,{variant:"ghost",size:"icon",onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-100","aria-label":"Sidebar einblenden",children:(0,r.jsx)(n.A,{className:"h-5 w-5"})})}),(0,r.jsx)("main",{className:"flex-1 overflow-hidden",children:d?(0,r.jsx)(eg,{messages:u,isLoading:m,onSend:v}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:(0,r.jsx)("p",{children:"Starte einen neuen Chat."})})})]})]})})}},3998:(e,t,a)=>{"use strict";a.d(t,{$:()=>d});var r=a(5155),s=a(2115),n=a(2467),l=a(3101),i=a(4269);let o=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:l,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,r.jsx)(u,{className:(0,i.cn)(o({variant:s,size:l,className:a})),ref:t,...c})});d.displayName="Button"},4269:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var r=a(2821),s=a(5889);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},5142:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});var r=a(5155),s=a(2115),n=a(4269);let l=s.forwardRef((e,t)=>{let{className:a,type:s,...l}=e;return(0,r.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},6347:(e,t,a)=>{"use strict";a.d(t,{ProtectedRoute:()=>i});var r=a(5155),s=a(854),n=a(4269);function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)("animate-pulse rounded-md bg-muted",t),...a})}function i(e){let{children:t}=e,{user:a,isLoading:n}=(0,s.A)();return n?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-900",children:(0,r.jsxs)("div",{className:"space-y-3 w-64",children:[(0,r.jsx)(l,{className:"h-8 w-full bg-gray-700"}),(0,r.jsx)(l,{className:"h-8 w-3/4 bg-gray-700"}),(0,r.jsx)(l,{className:"h-8 w-1/2 bg-gray-700"})]})}):a?(0,r.jsx)(r.Fragment,{children:t}):null}}},e=>{e.O(0,[516,97,441,255,358],()=>e(e.s=2325)),_N_E=e.O()}]);